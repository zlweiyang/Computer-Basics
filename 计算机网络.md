# 网络分层与各层协议 #
OSI7层模型：1.物理层,2.数据链路层,3.网络层,4.传输层,5.会话层,6.表示层,7.应用层

TCP/IP 4层模型:1.网络接口层,2.运输层,3.网际层,4.网络接口层

五层协议：1.物理层，2.数据链路层，3.网络层，4.运输层，5.应用层。

<div align="center"> <img src="../network1.png" width="450"/> </div><br>

应用层：域名系统DNS，万维网应用HTTP协议，发电子邮件SMTP协议，收邮件协议POP3，文件传输协议FTP。
运输层：传输控制协议TCP,用户数据协议UDP。报文段。      
网络层:IP协议。IP数据报。ARP、ICMP协议。包。     
数据链路层：封装成帧。  
物理层：数据单元为比特。

# 应用层 #
## HTTP协议 (超文本传输协议)

## 1.URL、URI、URN的区别 ##

- URI(统一资源标识符，web服务器资源的名字，例如：index.html)
- URL(统一资源定位符)
- URN(统一资源名称)

实际上URI包括URL、URN，目前只有URL比较流行，所以见到的基本都是URL。

## 2.HTTP的请求和响应报文 ##

**（1）请求报文**

<div align="center"> <img src="../HTTP_RequestMessageExample.png" width="450"/> </div><br>

HTTP请求由请求行、请求头、空行、请求数据4个部分组成，而请求行又包括请求方法字段、请求的URL地址、协议名称及版本组成。

**GET请求**

<div align="center"> <img src="../http_request_get.png" width="450"/> </div><br>

GET方式是最常见的一种请求方式。我们日常点击链接或者通过浏览器浏览网页，就是使用GET方式。GET方法要求服务器将URL定位的资源放在响应报文数据部分，回送到客户端。

**POST请求**

<div align="center"> <img src="../http_request_post.png" width="450"/> </div><br>

**（2）响应报文**

<div align="center"> <img src="../HTTP_ResponseMessageExample.png" width="450"/> </div><br>

HTTP响应报文也由三个部分组成，分别是：状态行、消息报头、响应正文。

**200响应**

<div align="center"> <img src="../http_response_200" width="450"/> </div><br>

**404响应**

<div align="center"> <img src="../http_response_400.png" width="450"/> </div><br>

## 3.HTTP状态码 ##
- 1xx:指示信息--请求已经接受，正在处理。
- 2xx:成功--请求正常接收完毕。
- 3xx:重定向--需要进行附加操作以完成请求。
- 4xx:客户端错误--请求语法错误或者请求无法实现。
- 5xx:服务端错误--服务器处理请求出错。



**无状态**：服务器不维护任何有关客户端过去所发请求的信息。

使用TCP传输服务：

服务器在80端口等待客户请求

浏览器发起到服务器的TCP连接（创建套接字Socket）

服务器接受来自浏览器的TCP连接

浏览器（HTTP客户端）与Web服务器（HTTP服务器）交换HTTP消息

关闭TCP连接

**HTTP1.0使用非持久性连接，每个TCP连接最多允许传输一个对象
HTTP1.1使用持久性连接，每个TCP连接允许传输多个对象**

HTTP协议有两类消息：请求消息(request)和响应消息(response)

**HTTP请求**

1.请求行：
请求方式：POST、GET
请求资源
协议版本

2.请求头：
客户端发给服务器端的一些信息。使用键值对表示key:value

3.请求体
当请求方式使post时，格式：username=zhangsan&password=123
如果请求方式为get，那么请求参数不会出现在请求体中。会拼接在URL地址后面
http://localhost:8080...?username=zhangsan&password=123


**HTTP的状态码 **

- 200 OK
- 301 永久移除
- 400 Bad Request
- 404 Not Found
- 505 HTTP Version Not Surpported

**HTTPS **

HTTP+SSL(TLS)
HTTPS在传输数据之前需要客户端与服务器进行一个握手(TLS/SSL握手)，在握手过程中将确立双方加密传输数据的密码信息。

# 传输层 #

## TCP ##
- 面向连接：客户机/服务器进程间需要建立连接
- 可靠的传输
- 只能一对一
- 面向字节流
- 流量控制：发送方不会发送速度过快，超过接收方的处理能力
- 拥塞控制：当网络负载过重时能够限制发送方的发送速度

**三次握手**

- 客户端-发送带有SYN标志的数据包--一次握手--服务端
- 服务端-发送带有SYN/ACK标志的数据包--二次握手--客户端
- 客户端-发送带有ACK标志的数据包--三次握手--服务端

第一次握手：服务端确认客户端发送正常  
第二次握手：客户端确认自己发送、接收正常，服务端发送、接收正常；服务器确认自己接收正常，客户端发送正常。
第三次握手：客户端确认自己发送接收正常，服务器发送接收正常；服务器确认自己发送接收正常。

**四次挥手**

- 客户端-发送一个FIN，用来关闭客户端到服务端的数据传输
- 服务器-收到一个FIN，它发回一个ACK，确认序号为收到的序号加1.和SYN一样，一个FIN将占用一个序号。
- 服务器-关闭与客户端的连接，发送一个FIN给客户端
- 客户端-发回ACK报文确认，并将确认序号设置为收到序号加1

**滑动窗口**

**拥塞控制**

**超时重传**

## UDP ##
- 无连接
- 不可靠数据传输
- 尽最大努力交付
- 面向报文
- 支持一对一，一对多，多对一和多对多的交互通信
- UDP首部开销小，8个字节

# 网络层 #

## IP地址 ## 

从输入URL到页面加载发生了什么？
总体分为以下几个过程：

- 1.DNS解析，查找域名的IP地址
- 2.TCP连接，与服务器建立TCP连接，在建立TCP连接时，需要发送数据，发送数据在网络层使用IP协议。IP数据包在路由器之间，路由选择使用OPSF协议。路由器在于服务器通信时，使用ARP协议将ip地址转换为MAC地址。
- 3.发送HTTP请求
- 4.服务器处理请求并返回HTTP报文
- 5.浏览器解析渲染页面
- 6.连接结束

**有类地址划分：**

IP地址：NetID + HostID

A：**0**  NetID(8位)+HostID(24位)   50% 0.0.0.0~127.255.255.255

B：**10** NetID(16位)+HostID(24位)  25% 128.0.0.0~191.255.255.255

C：**110 **NetID(16位)+HostID(24位) 12.5% 192.0.0.0~223.255.255.255

D:**1110** 6.5% 224.0.0.0~239.255.255.255

E:**1111** 6.5% 224.0.0.0~255.255.255.255

私有地址：
A:10,1 B:172.16 to 172.31,16 C:192.168.0 to 192.168.255,256

**IP子网以及子网掩码**

子网掩码：NetID、SubID全为1，HostId全为0

CIDR技术：提高IPv4地址空间分配效率，提高路由效率：1.将多个子网聚合为一个较大的子网，2.构造超网，路由聚合。

**无类IP地址格式**： a.b.c.d/x,x为前缀长度，例如：200.23.16.0/23。

DHCP协议(通过UDP协议封装到IP数据包)：

动态主机配置协议-DHCP：DHCP server

**都以广播形式**

客户端：  发现报文 DHCP discover。

DHCP服务器：发送提供报文 DHCP offer。

客户端：发送请求报文，DHCP request。

DHCP服务器：发送确认报文 DHCP ack。

互联网控制报文协议(ICMP)：支持主机或路由器：1.差错报告。2.网络探询。

差错报告报文：1.目的不可达。2.源抑制。3.超时/超期110(TTL超期)。4.参数问题120(IP首部错误)。5.重定向。

网络探询报文：1.回声请求与应答报文：(ping)00，80。2.时间戳请求和应答报文。

## 路由算法 ##
路由算法：从源端口到目的端口的寻找最小费用路径的算法

链路状态路由算法：Dijkstra算法。

距离向量路由算法
# 数据链路层 #

# 物理层 #
